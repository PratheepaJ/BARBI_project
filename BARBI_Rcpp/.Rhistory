hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("P-gamma", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..), fill = "blue") + xlab("X") +theme_bw() +ylab("")
nbd <- rnbinom(n1,size=2, mu=1/3)
com.x1.x2 <- c(nbd)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("nb", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..),fill = "blue") + xlab(bquote(K[ij])) +theme_bw() +ylab("")
n1=200
x1 <- rpois(n1,rgamma(n1,shape = 2, rate = 6))
com.x1.x2 <- c(x1)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("P-gamma", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..), fill = "blue") + xlab("X") +theme_bw() +ylab("")
nbd <- rnbinom(n1,size=2, mu=1/3)
com.x1.x2 <- c(nbd)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("nb", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..),fill = "blue") + xlab(bquote(K[ij]^(c))) +theme_bw() +ylab("")
n1=200
x1 <- rpois(n1,rgamma(n1,shape = 18, rate = 2))
com.x1.x2 <- c(x1)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("P-gamma", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..),fill="brown") + xlab(bquote(K[ij]^(r))) +theme_bw() +ylab("")
nbd <- rnbinom(n1,size=18, mu=9)
com.x1.x2 <- c(nbd)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("nb", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..),fill="brown") + xlab(bquote(K[ij]^(r))) +theme_bw() +ylab("")
n1=200
n2=200
x1 <- rgamma(n1,shape = 2, rate = 6)
x2 <- rgamma(n2,shape = 2, rate = 4)
x3 <- rgamma(n2,shape = 8, rate = 2)
x4 <- rgamma(n2,shape = 6, rate = 2)
com.x1.x2 <- c(x1,x2, x3,x4)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("sub1", n1),rep("sub2", n1), rep("sub3", n1), rep("sub4", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..), alpha = .2) + xlab(bquote(lambda[ij]^(r), lambda[ij]^(c))) +theme_bw() +ylab("")
n1=200
n2=200
x1 <- rgamma(n1,shape = 2, rate = 6)
x2 <- rgamma(n2,shape = 2, rate = 4)
x3 <- rgamma(n2,shape = 8, rate = 2)
x4 <- rgamma(n2,shape = 6, rate = 2)
com.x1.x2 <- c(x1,x2, x3,x4)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("sub1", n1),rep("sub2", n1), rep("sub3", n1), rep("sub4", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..), alpha = .2) + xlab(bquote(lambda[ij]^(r), lambda[ij]^(c))) +theme_bw() +ylab("")
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..), alpha = .2) + xlab(bquote(paste0(lambda[ij]^(r),"or", lambda[ij]^(c)))) +theme_bw() +ylab("")
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..), alpha = .2) + xlab(paste0(bquote(lambda[ij]^(r)),"or", bquote(lambda[ij]^(c)))) +theme_bw() +ylab("")
n1=200
n2=200
x1 <- rgamma(n1,shape = 2, rate = 6)
x2 <- rgamma(n2,shape = 2, rate = 4)
x3 <- rgamma(n2,shape = 8, rate = 2)
x4 <- rgamma(n2,shape = 6, rate = 2)
com.x1.x2 <- c(x1,x2, x3,x4)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("sub1", n1),rep("sub2", n1), rep("sub3", n1), rep("sub4", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..), alpha = .2) + xlab(bquote(lambda[ij]^(r) lambda[ij]^(c))) +theme_bw() +ylab("")
n1=200
n2=200
x1 <- rgamma(n1,shape = 2, rate = 6)
x2 <- rgamma(n2,shape = 2, rate = 4)
x3 <- rgamma(n2,shape = 8, rate = 2)
x4 <- rgamma(n2,shape = 6, rate = 2)
com.x1.x2 <- c(x1,x2, x3,x4)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("sub1", n1),rep("sub2", n1), rep("sub3", n1), rep("sub4", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..), alpha = .2) + xlab(bquote(lambda[ij]^(r))) +theme_bw() +ylab("")
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..), alpha = .2) + xlab(bquote(lambda[ij]^(r)/lambda[ij]^(c))) +theme_bw() +ylab("")
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..), alpha = .2) + xlab(bquote(lambda[ij]^(r),lambda[ij]^(c))) +theme_bw() +ylab("")
n1=200
n2=200
x1 <- rgamma(n1,shape = 2, rate = 6)
x2 <- rgamma(n2,shape = 2, rate = 4)
x3 <- rgamma(n2,shape = 8, rate = 2)
x4 <- rgamma(n2,shape = 6, rate = 2)
com.x1.x2 <- c(x1,x2, x3,x4)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("sub1", n1),rep("sub2", n1), rep("sub3", n1), rep("sub4", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..), alpha = .2) + xlab(bquote(lambda[ij]^(r)\n lambda[ij]^(c))) +theme_bw() +ylab("")
n1=200
n2=200
x1 <- rgamma(n1,shape = 2, rate = 6)
x2 <- rgamma(n2,shape = 2, rate = 4)
x3 <- rgamma(n2,shape = 8, rate = 2)
x4 <- rgamma(n2,shape = 6, rate = 2)
com.x1.x2 <- c(x1,x2, x3,x4)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("sub1", n1),rep("sub2", n1), rep("sub3", n1), rep("sub4", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..), alpha = .2) + xlab(bquote(lambda[ij]^(r) "and" lambda[ij]^(c))) +theme_bw() +ylab("")
n1=200
n2=200
x1 <- rgamma(n1,shape = 2, rate = 6)
x2 <- rgamma(n2,shape = 2, rate = 4)
x3 <- rgamma(n2,shape = 8, rate = 2)
x4 <- rgamma(n2,shape = 6, rate = 2)
com.x1.x2 <- c(x1,x2, x3,x4)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("sub1", n1),rep("sub2", n1), rep("sub3", n1), rep("sub4", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..), alpha = .2) + xlab(bquote(lambda[ij]^(r) ~"and"~ lambda[ij]^(c))) +theme_bw() +ylab("")
n1=200
n2=200
x1 <- rgamma(n1,shape = 2, rate = 6)
x2 <- rgamma(n2,shape = 2, rate = 4)
x3 <- rgamma(n2,shape = 8, rate = 2)
x4 <- rgamma(n2,shape = 6, rate = 2)
com.x1.x2 <- c(x1,x2, x3,x4)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("sub1", n1),rep("sub2", n1), rep("sub3", n1), rep("sub4", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..), alpha = .2) + xlab(bquote(lambda[ij]^(r) ~"or"~ lambda[ij]^(c))) +theme_bw() +ylab("")
n1=200
x1 <- rpois(n1,rgamma(n1,shape = 2, rate = 6))
com.x1.x2 <- c(x1)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("P-gamma", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..), fill = "blue") + xlab("X") +theme_bw() +ylab("")
nbd.c <- rnbinom(n1,size=2, mu=1/3)
com.x1.x2 <- c(nbd.c)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("nb", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..),fill = "blue") + xlab(bquote(K[ij]^(c))) +theme_bw() +ylab("")
n1=200
x1 <- rpois(n1,rgamma(n1,shape = 18, rate = 2))
com.x1.x2 <- c(x1)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("P-gamma", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..),fill="brown") + xlab(bquote(K[ij]^(r))) +theme_bw() +ylab("")
nbd.r <- rnbinom(n1,size=18, mu=9)
com.x1.x2 <- c(nbd.r)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("nb", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..),fill="brown") + xlab(bquote(K[ij]^(r))) +theme_bw() +ylab("")
com.x1.x2 <- c(nbd.r,nbd.r)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("nb", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..),fill="brown") + xlab(bquote(K[ij]^(r))) +theme_bw() +ylab("")
com.x1.x2 <- c(nbd.r,nbd.r)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("nb", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..),fill="brown") + xlab(bquote(K[ij]^(r)+
K[ij]^(c))) +theme_bw() +ylab("")
com.x1.x2 <- c(nbd.r,nbd.r)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("nb", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..),fill="brown",alpha=.2) + xlab(bquote(K[ij]^(r)+
K[ij]^(c))) +theme_bw() +ylab("")
n1=200
n2=200
x1 <- rgamma(n1,shape = 2, rate = 6)
# x2 <- rgamma(n2,shape = 2, rate = 4)
# x3 <- rgamma(n2,shape = 8, rate = 2)
x4 <- rgamma(n2,shape = 6, rate = 2)
com.x1.x2 <- c(x1,x4)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("sub1", n1),rep("sub4", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..), alpha = .2) + xlab(bquote(lambda[ij]^(r) ~"or"~ lambda[ij]^(c))) +theme_bw() +ylab("")
n1=200
n2=200
x4 <- rgamma(n1,shape = 2, rate = 6)
# x2 <- rgamma(n2,shape = 2, rate = 4)
# x3 <- rgamma(n2,shape = 8, rate = 2)
x1 <- rgamma(n2,shape = 6, rate = 2)
com.x1.x2 <- c(x1,x4)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("sub1", n1),rep("sub4", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..), alpha = .2) + xlab(bquote(lambda[ij]^(r) ~"or"~ lambda[ij]^(c))) +theme_bw() +ylab("")
n1=200
n2=200
x4 <- rgamma(n1,shape = 2, rate = 6)
# x2 <- rgamma(n2,shape = 2, rate = 4)
# x3 <- rgamma(n2,shape = 8, rate = 2)
x1 <- rgamma(n2,shape = 6, rate = 2)
com.x1.x2 <- c(x1,x4)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("sub1", n1),rep("sub4", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..), alpha = .2) + xlab("") +theme_bw() +ylab("")
prior.lambda.r <- function(l.r,l.c = 4){
sqrt(l.c/(l.c+l.r))
}
l.r <- seq(1,1000)
prior.lambda.rr <- prior.lambda.r(l.r)
df.l.r <- data.frame(l.r = l.r, prior.lambda.rr = prior.lambda.rr)
ggplot(df.l.r)+ geom_point(aes(x = l.r, y= prior.lambda.rr), color = "blue") + xlab(bquote(lambda^(r))) + ylab(bquote(Pi(lambda^(r))))
prior.lambda.r <- function(l.r,l.c = 4){
sqrt(l.c/(l.c+l.r))
}
l.r <- seq(1,1000)
prior.lambda.rr <- prior.lambda.r(l.r)
df.l.r <- data.frame(l.r = l.r, prior.lambda.rr = prior.lambda.rr)
ggplot(df.l.r)+ geom_density(aes(x= prior.lambda.rr), color = "brown") + xlab(bquote(lambda^(r))) + ylab(bquote(Pi(lambda^(r))))
prior.lambda.r <- function(l.r,l.c = 4){
sqrt(l.c/(l.c+l.r))
}
l.r <- seq(1,1000)
prior.lambda.rr <- prior.lambda.r(l.r)
df.l.r <- data.frame(l.r = l.r, prior.lambda.rr = prior.lambda.rr)
ggplot(df.l.r)+ geom_density(aes(x= prior.lambda.rr), fill= "brown",color = "brown") + xlab(bquote(lambda^(r))) + ylab(bquote(Pi(lambda^(r))))
prior.lambda.r <- function(l.r,l.c = 4){
sqrt(l.c/(l.c+l.r))
}
l.r <- seq(1,1000)
prior.lambda.rr <- prior.lambda.r(l.r)
df.l.r <- data.frame(l.r = l.r, prior.lambda.rr = prior.lambda.rr)
ggplot(df.l.r)+ geom_density(aes(x= prior.lambda.rr), fill= "brown",color = "brown",alpha=.2) + xlab(bquote(lambda^(r))) + ylab(bquote(Pi(lambda^(r))))
prior.lambda.r <- function(l.r,l.c = 4){
sqrt(l.c/(l.c+l.r))
}
l.r <- seq(1,1000)
prior.lambda.rr <- prior.lambda.r(l.r)
df.l.r <- data.frame(l.r = l.r, prior.lambda.rr = prior.lambda.rr)
ggplot(df.l.r)+ geom_density(aes(x= prior.lambda.rr, y=..scaled..), fill= "brown",color = "brown",alpha=.2) + xlab(bquote(lambda^(r))) + ylab(bquote(Pi(lambda^(r))))
n1=200
n2=200
x4 <- rgamma(n1,shape = 2, rate = 6)
# x2 <- rgamma(n2,shape = 2, rate = 4)
# x3 <- rgamma(n2,shape = 8, rate = 2)
x1 <- rgamma(n2,shape = 8, rate = 2)
com.x1.x2 <- c(x1,x4)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("sub1", n1),rep("sub4", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..), alpha = .2) + xlab("") +theme_bw() +ylab("")
n1=200
n2=200
x4 <- rgamma(n1,shape = 1.5, rate = 6)
# x2 <- rgamma(n2,shape = 2, rate = 4)
# x3 <- rgamma(n2,shape = 8, rate = 2)
x1 <- rgamma(n2,shape = 8, rate = 2)
com.x1.x2 <- c(x1,x4)
hist(com.x1.x2)
df <- data.frame(com.x1.x2 = com.x1.x2, mix = c(rep("sub1", n1),rep("sub4", n1)))
ggplot(df, aes(x = com.x1.x2, group = mix, fill = mix)) +geom_density(aes(y = ..scaled..), alpha = .2) + xlab("") +theme_bw() +ylab("")
psignrank(62,12,lower.tail=F)
knitr::opts_chunk$set(echo = TRUE, fig.width = 3,fig.height = 3,message=FALSE, warning=FALSE)
pre = c(1.83, .50, 1.62, 2.48, 1.68, 1.88,
1.55, 3.06, 1.30)
post = c(.878, .647, .598, 2.05, 1.06, 1.29,
1.06, 3.14, 1.29)
wilcox.test(post, pre, paired=TRUE,
alterative = "less")
wilcox.test(x = post, y = pre, paired=TRUE,
alterative = "less")
wilcox.test(x = post, y = pre, paired=TRUE, alterative = "less")
wilcox.test(x = post, y = pre, paired=TRUE, alterative = "greater")
wilcox.test(x = post, y = pre, paired=TRUE, alterative = "two.sided")
wilcox.test(x = post, y = pre, paired=FALSE
, alterative = "two.sided")
rep(3,0)
dmultinom(c(2,3,1,1),prob = rep(1,4))
install.packages("Rcpp")
setwd("/Users/jpratheepa31/Dropbox/GitHub/BARBI_project/BARBI_Rcpp")
knitr::opts_chunk$set(echo = TRUE)
library(Rcpp)
sourceCpp("MyFunc.cpp")
cppFunction('int add(int x, int y, int z) {
int sum = x + y + z;
return sum;
}')
add(1,2,3)
one <- function() 1L
one
one()
cppFunction(fn)
fn = 'int one() {
return 1;
}'
cppFunction(fn)
one()
fn2 = 'int signR(){
if (x > 0) {
fn2 = 'int signR(){
cppFunction('int signR(){
if (x > 0) {
return 1;
} else if (x == 0){
return 0;
} else{
return -1;
}
}')
cppFunction('int signR(x){
if (x > 0) {
return 1;
} else if (x == 0){
return 0;
} else{
return -1;
}
}')
cppFunction('int signR(int x){
if (x > 0) {
return 1;
} else if (x == 0){
return 0;
} else{
return -1;
}
}')
signR(10)
cppFunction('double sumC(NumericVector x){
int n = x.size();
double total = 0;
for(int i = 0; i < n; ++i){
total += x[i]
}
return total;
}')
cppFunction('double sumC(NumericVector x){
int n = x.size();
double total = 0;
for(int i = 0; i < n; ++i){
total += x[i];
}
return total;
}')
x = runif(1e3)
install.packages("microbenchmark")
library(microbenchmark)
microbenchmark(sum(x), sumR(x), sumC(x))
sumR = function(x){
total = 0
for(i in seq_along(x)){
total = total + x[i]
}
total
}
library(microbenchmark)
x = runif(1e3)
microbenchmark(sum(x), sumR(x), sumC(x))
knitr::opts_chunk$set(echo = TRUE, fig.width = 3,fig.height = 3,message=FALSE, warning=FALSE)
n = 10; p0 = 1/2; nsim = 10000; B = rbinom(nsim, size = n, prob = p0)
hist(B, breaks = 30)
Z = rnorm(1000, mean = n*p0,sd = sqrt(n*p0*(1-p0)))
qqplot(x = Z, y = B)
# Z = rnorm(1000, mean = n*p0,sd = sqrt(n*p0*(1-p0)))
df = data.frame(B=B)
library(ggplot2)
ggplot(df, aes(sample = B))+stat_qq()
knitr::opts_chunk$set(echo = TRUE, fig.width = 3,fig.height = 3, fig.align="center",message=FALSE, warning=FALSE)
qnorm((1-.05), mean = 0, sd =1)
B.star = (25 - 50*1/3)/(sqrt(50*1/3*2/3)); B.star
1 - pnorm(2.5)
chisq.test(c(5474,1850), p=c(.75,.25))
chisq.test(c(6022,2001), p=c(.75,.25))
df = data.frame(Dominant = c(5474,6022,705,882,428,651,787), Recessive = c(1850,2001,224,299,152,207,277))
rownames(df) = c("Seed_shape", "Cotyledon_color", "Seed_coat_color", "Pod_shape", "Pod_color", "Flower_position", "Stem_length")
df
library(dplyr)
df = mutate(df, expected.ratio = rep("1:3",times = 7))
df = mutate(df, expected.ratio = rep("1:3",times = 7)); df
df
class(df)
df = data.frame(Dominant = c(5474,6022,705,882,428,651,787),
Recessive = c(1850,2001,224,299,152,207,277))
rownames(df) = c("Seed_shape", "Cotyledon_color",
"Seed_coat_color", "Pod_shape", "Pod_color",
"Flower_position", "Stem_length"); df
library(dplyr)
df = mutate(df, expected.ratio = rep("1:3",times = 7)); df
library(dplyr)
df = mutate(df,
expected.ratio = rep("1:3",times = 7));
rownames(df) = c("Seed_shape", "Cotyledon_color",
"Seed_coat_color", "Pod_shape", "Pod_color",
"Flower_position", "Stem_length"); df
library(dplyr)
df = mutate(df,
expected.ratio = rep("3:1",times = 7));
rownames(df) = c("Seed_shape", "Cotyledon_color",
"Seed_coat_color", "Pod_shape", "Pod_color",
"Flower_position", "Stem_length"); df
df = mutate(df, chi.sq = chisq.test(c(Dominant, Recessive), p=c(.75,.25)))
chisq.test(x = df$Dominant, y=df$Recessive, p = rep(3/4,length(df$Dominant)))
chisq.test(table(df[,1:2]))
chisq.test(c(x[1],x[2]), p = c(.75, .25))
chi.sq = apply(df, 1, function(x){
chisq.test(c(x[1],x[2]), p = c(.75, .25))
})
df
df = data.frame(Dominant = c(5474,6022,705,882,428,651,787),
Recessive = c(1850,2001,224,299,152,207,277))
rownames(df) = c("Seed_shape", "Cotyledon_color",
"Seed_coat_color", "Pod_shape", "Pod_color",
"Flower_position", "Stem_length"); df
chi.sq = apply(df, 1, function(x){
chisq.test(c(x[1],x[2]), p = c(.75, .25))
})
chi.sq
ft = chisq.test(c(5474,1850), p=c(.75,.25))
ft$statistic
library(dplyr); df = mutate(df,
expected.ratio = rep("3:1",times = 7));
rownames(df) = c("Seed_shape", "Cotyledon_color", "Seed_coat_color", "Pod_shape", "Pod_color", "Flower_position", "Stem_length"); df
chi.sq = apply(df, 1, function(x){
chisq.test(c(x[1],x[2]), p = c(.75, .25))$statistic
})
chi.sq = apply(df[,1:2], 1, function(x){
chisq.test(c(x[1],x[2]), p = c(.75, .25))$statistic
})
chi.sq
chi.sq = apply(df[,1:2], 1, function(x){
chisq.test(c(x[1],x[2]),
p = c(.75, .25))$statistic
}); df = mutate(df, chi.sq = chi.sq)
df
chi.sq = apply(df[,1:2], 1, function(x){
chisq.test(c(x[1],x[2]),
p = c(.75, .25))$statistic
}); df = mutate(df, chi.sq = chi.sq); df = data.frame(df)
chi.sq = apply(df[,1:2], 1, function(x){
chisq.test(c(x[1],x[2]),
p = c(.75, .25))$statistic
}); df = mutate(df, chi.sq = chi.sq); df = data.frame(df); df
chi.sq = apply(df[,1:2], 1, function(x){
chisq.test(c(x[1],x[2]),
p = c(.75, .25))$statistic
}); df = mutate(df, chi.sq = chi.sq); df = as.data.frame(df); df
df = data.frame(Dominant = c(5474,6022,705,882,428,651,787),
Recessive = c(1850,2001,224,299,152,207,277))
rownames(df) = c("Seed_shape", "Cotyledon_color",
"Seed_coat_color", "Pod_shape", "Pod_color",
"Flower_position", "Stem_length"); df
library(dplyr); df = mutate(df,
expected.ratio = rep("3:1",times = 7));
rownames(df) = c("Seed_shape", "Cotyledon_color", "Seed_coat_color", "Pod_shape", "Pod_color", "Flower_position", "Stem_length"); df
chi.sq = apply(df[,1:2], 1, function(x){
chisq.test(c(x[1],x[2]),
p = c(.75, .25))$statistic
}); df = mutate(df, chi.sq = chi.sq); df = as.data.frame(df); df
sum(df$chi.sq)
pchisq(sum(df$chi.sq), df = 7)
colSums(df[,1:2])
sum(colSums(df[,1:2]))
pbinom(seq(1,5),size = 5, prob = .5)
pbinom(seq(1,6),size = 6, prob = .5)
pbinom(seq(1,7),size = 7, prob = .5)
pbinom(seq(1,8),size = 8, prob = .5)
1-pbinom(seq(1,8),size = 8, prob = .5)
1-pbinom(seq(0,8),size = 8, prob = .5)
x = c(2,3,4,5,6,-1,-2,-3)
library(BSDA)
SIGN.test(x)
SIGN.test(x, alternative ="greater")
SIGN.test(x, alternative ="less")
SIGN.test(x, alternative ="greater")
x
x.ch = x
x.ch[6] = 8
x = c(2,3,4,5,6,-11,-21,-30)
SIGN.test(x, alternative ="greater")
1-pbinom(4,size = 8, prob = .5)
1-pbinom(seq(0,7),size = 8, prob = .5)
1-pbinom(seq(0,8),size = 8, prob = .5)
1-pbinom(0,size = 8, prob = .5)
dbinom(0,8,.5)
1-dbinom(0,8,.5)
x = c(2,3,4,5,6,11,-21,-30)
SIGN.test(x, alternative ="greater")
x = c(2,3,4,5,6,11,21,-30)
SIGN.test(x, alternative ="greater")
1-pbinom(seq(0,10),size = 8, prob = .5)
knitr::opts_chunk$set(echo = TRUE)
1-pbinom(seq(0,10),size = 8, prob = .5)
1-pbinom(seq(0,10),size = 10, prob = .5)
1-pbinom(seq(0,9),size = 10, prob = .5)
x = c(-20,-15,-10, 5, 15, 20, 25, 30, 35, 38, 26)
library(BSDA)
SIGN.test(x, alternative = "greater")
x[3] = 10
SIGN.test(x, alternative = "greater")
knitr::opts_chunk$set(echo = TRUE, message = FALSE)
sign.test.pvalue = 1 - pbinom(7,size = 25, prob = .5)
sign.test.pvalue = 1 - pbinom(7,size = 25, prob = .5);sign.test.pvalue
B.star = (8-25*(.5))/25*(.5)*(.5)
B.star = (8-25*(.5))/25*(.5)*(.5); B.star
exact.pvalue = pbinom(8,size = 25, prob = .5);exact.pvalue
B.star = (8-25*(.5))/25*(.5)*(.5); B.star
appro.pvlaue = pnorm(B.star); appro.pvlaue
B.star = (8-25*(.5))/sqrt(25*(.5)*(.5)); B.star
appro.pvlaue = pnorm(B.star); appro.pvlaue
x.before <- c(349, 400,520, 490, 574, 427, 435)
y.after <- c(425,533,362,628, 463, 427, 449)
wilcox.test(x = y.after, y= x.before, alternative = "greater")
wilcox.test(x = y.after, y= x.before, alternative = "greater", correct = TRUE)
wilcox.test(x = y.after, y= x.before, alternative = "greater", correct = TRUE, paired = TRUE)
y.after - x.before
x.before <- c(349, 400, 520, 490, 574, 427, 435)
y.after <- c(425, 533, 362, 628, 463, 427, 449)
wilcox.test(x = y.after, y= x.before, alternative = "greater", correct = TRUE, paired = TRUE)
z.difference = y.after - x.before
boxplot(z.difference)
wilcox.test(x = z.difference, alternative = "greater", correct = TRUE)
z.difference
library(ICSNP)
hl.loc(z.difference)
median(z.difference)
dim(df)
df = data.frame(X = c(5.8,13.5,26.1,7.4,7.6,23,10.7,9.1, 19.3,26.3,17.5,17.9,18.3,14.2,55.2,15.4,30,21.3, 26.8,8.1,24.3, 21.3,18.2,22.5,31.1),
Y = c(5,21,73,25,3,77,59,13,36,46,9,25,
59,38,70,36,55,46,25,30,29,46,71,31,33)) ;head(df)
df = data.frame(X = c(5.8,13.5,26.1,7.4,7.6,23,10.7,9.1, 19.3,26.3,17.5,17.9,18.3,14.2,55.2,15.4,30,21.3, 26.8,8.1,24.3, 21.3,18.2,22.5,31.1),
dim(df)
qbinom(.025, size = 25, prob = .5, lower.tail = FALSE)
SIGN.test(x= df$Z, alternative = "greater", conf.level = .9461)
df = data.frame(X = c(5.8,13.5,26.1,7.4,7.6,23,10.7,9.1, 19.3,26.3,17.5,17.9,18.3,
14.2,55.2,15.4,30,21.3, 26.8,8.1,24.3,
21.3,18.2,22.5,31.1),
Y = c(5,21,73,25,3,77,59,13,36,46,9,25,
59,38,70,36,55,46,25,30,29,46,71,31,33)) ;head(df)
library(dplyr)
df = mutate(df, Z= Y-X, Psi = ifelse(Z > 0 ,1,0)); head(df)
SIGN.test(x= df$Z, alternative = "greater", conf.level = .9461)
